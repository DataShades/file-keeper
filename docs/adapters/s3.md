# AWS S3 Adapter

The `file_keeper:s3` adapter allows you to use [Amazon
S3](https://aws.amazon.com/s3/) for storing and retrieving files. This adapter
leverages the `boto3` Python library.

## Overview

This adapter provides a convenient way to integrate AWS S3 with
file-keeper. You'll need to have the `boto3` library installed and configure it
with the appropriate credentials for your AWS account.

```sh
pip install 'file-keeper[s3]'

## or

pip install boto3
```


## Initialization Example

Here's an example of how to initialize the S3 adapter:


/// tab | AWS S3

```py
storage = make_storage("my_s3_storage", {
    "type": "file_keeper:s3",
    "key": "***",
    "secret": "***",
    "bucket": "file-keeper",
    "initialize": True,
})

```

///

/// tab | MinIO

```python
storage = make_storage("my_s3_storage", {
    "type": "file_keeper:s3",
    "key": "minioadmin",
    "secret": "minioadmin",
    "bucket": "file-keeper",
    "endpoint": "http://127.0.0.1:9000/",
    "initialize": True,
})
```
///

/// tab | Environment variables

Set environment variables mentioned in [boto3
documentations](https://boto3.amazonaws.com/v1/documentation/api/latest/guide/configuration.html#using-environment-variables). In this way you don't need to use hardcoded secrets.

```sh
export AWS_ACCESS_KEY_ID=minioadmin
export AWS_SECRET_ACCESS_KEY=minioadmin
export AWS_ENDPOINT_URL=http://127.0.0.1:9000
```

Then storage will automatially pick any missing options from envvars

```py
storage = make_storage("my_s3_storage", {
    "type": "file_keeper:s3",
    "bucket": "file-keeper",
})
```
///

/// tab | AWS config file

Just like environment variables, you can use [configuration file](https://boto3.amazonaws.com/v1/documentation/api/latest/guide/configuration.html#using-a-configuration-file). It will be located at `~/.aws/credentials` or a different location specified by `AWS_CONFIG_FILE`.

Add default profile there

```ini
[default]
aws_access_key_id = minioadmin
aws_secret_access_key = minioadmin
endpoint_url = http://127.0.0.1:9000
```

Or, if you want to use different profile name, set `AWS_PROFILE` with the name
of prefered credentials profile. And now you can initialize the storage without
specifying parameters that are set by the profile:

```py
storage = make_storage("my_s3_storage", {
    "type": "file_keeper:s3",
    "bucket": "file-keeper",
})
```
///

/// tab | Existing S3 client

If you already have initialized `boto3.client("s3")`, you can just reuse it
instead of specifying key and secret:

```py

s3_client = boto3.client("s3", ...) # somehow you've initialized it

storage = make_storage("my_s3_storage", {
    "type": "file_keeper:s3",
    "bucket": "file-keeper",
    "client": s3_client
})
```

///



**Important Notes:**

*   Replace the placeholder values (bucket, region, access\_key\_id,
    secret\_access\_key) with your actual AWS account credentials and
    configuration.
*   Ensure that you have created a bucket in your AWS S3 account to store the
    files.
*   For enhanced security, consider using IAM roles instead of hardcoding
    access keys.
*   Refer to the [AWS S3 documentation](https://aws.amazon.com/s3/) for more
    information about AWS S3.
